<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å­¦å‘˜ç®¡ç†ç³»ç»Ÿ v3.0 (è‡ªåŠ¨è¯»å–ç‰ˆ)</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif; background: #f5f5f5; padding: 20px; }
        .container { max-width: 1200px; margin: 0 auto; }
        .section { background: white; padding: 25px; border-radius: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); margin-bottom: 20px; }
        h1 { margin-bottom: 10px; color: #333; }
        h2 { font-size: 18px; margin-bottom: 20px; color: #333; border-bottom: 2px solid #f0f0f0; padding-bottom: 10px; }
        .form-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-bottom: 20px; }
        .form-group { display: flex; flex-direction: column; }
        .form-group label { margin-bottom: 5px; font-weight: 500; font-size: 14px; }
        .form-group input { padding: 10px; border: 1px solid #ddd; border-radius: 6px; }
        .btn { padding: 10px 20px; border: none; border-radius: 6px; cursor: pointer; font-weight: 500; transition: 0.3s; color: white; }
        .btn-primary { background: #0052D9; }
        .btn-success { background: #2ba471; }
        .btn-danger { background: #d54941; padding: 5px 10px; font-size: 12px; }
        table { width: 100%; border-collapse: collapse; margin-top: 10px; }
        th, td { padding: 12px; text-align: left; border-bottom: 1px solid #eee; font-size: 14px; }
        th { background: #f9f9f9; font-weight: 600; }
        .code-area { width: 100%; height: 200px; padding: 15px; border: 1px solid #ddd; border-radius: 6px; font-family: monospace; font-size: 13px; margin-top: 15px; background: #2d2d2d; color: #f8f8f2; }
        .badge { background: #e3f2fd; color: #1976d2; padding: 2px 8px; border-radius: 4px; font-size: 12px; }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ“ å­¦å‘˜ç®¡ç†ç³»ç»Ÿ v3.0</h1>
        <p style="color: #666; margin-bottom: 20px;">âœ… å·²è‡ªåŠ¨è¿æ¥ config.jsï¼Œå½“å‰æ˜¾ç¤ºçš„æ˜¯æœ€æ–°æ•°æ®ã€‚</p>

        <div class="section">
            <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:15px;">
                <h2>ğŸ“‹ ç°æœ‰å­¦å‘˜åˆ—è¡¨ (<span id="count">0</span>äºº)</h2>
                <div style="font-size:12px; color:#666;">
                    å½“å‰ Token: <span id="currentTokenDisplay">...</span>
                </div>
            </div>
            
            <table>
                <thead>
                    <tr><th>æ‰‹æœºå·</th><th>å§“å</th><th>å¯†ç </th><th>è€å¸ˆ</th><th>æ“ä½œ</th></tr>
                </thead>
                <tbody id="studentTableBody">
                    </tbody>
            </table>
        </div>
        
        <div class="section">
            <h2>â• æ·»åŠ æ–°å­¦å‘˜</h2>
            <div class="form-grid">
                <div class="form-group"><label>æ‰‹æœºå·</label><input type="text" id="phone" placeholder="13800138000"></div>
                <div class="form-group"><label>å¯†ç </label><input type="text" id="password" value="123456"></div>
                <div class="form-group"><label>å§“å</label><input type="text" id="studentName" placeholder="ç‹å°æ˜"></div>
                <div class="form-group"><label>è€å¸ˆ</label><input type="text" id="teacherName" value="æ—é›¨è€å¸ˆ"></div>
                <div class="form-group"><label>æ™ºèƒ½ä½“ID (Agent ID)</label><input type="text" id="agentId" placeholder="ç²˜è´´ID..."></div>
            </div>
            <button class="btn btn-primary" onclick="addStudent()">æ·»åŠ å­¦å‘˜</button>
        </div>

        <div class="section">
            <h2>ğŸ’¾ ä¿å­˜é…ç½®</h2>
            <p style="font-size:14px; color:#666;">å› ä¸ºæµè§ˆå™¨å®‰å…¨é™åˆ¶ï¼Œæ— æ³•ç›´æ¥ä¿®æ”¹æ–‡ä»¶ã€‚è¯·ç‚¹å‡»ç”Ÿæˆï¼Œç„¶åå¤åˆ¶æ–°ä»£ç å» GitHub è¦†ç›– config.jsã€‚</p>
            <button class="btn btn-success" onclick="generateConfig()">ğŸš€ ç”Ÿæˆæ–° config.js ä»£ç </button>
            <button class="btn btn-primary" onclick="copyConfig()">ğŸ“‹ ä¸€é”®å¤åˆ¶</button>
            <textarea id="configOutput" class="code-area" readonly placeholder="ç‚¹å‡»ç”ŸæˆæŒ‰é’®åï¼Œæ–°ä»£ç ä¼šå‡ºç°åœ¨è¿™é‡Œ..."></textarea>
        </div>
    </div>

    <script src="config.js"></script>
    
    <script>
        // æœ¬åœ°å†…å­˜æ•°æ®
        let students = [];
        let currentToken = '';
        let currentApiUrl = '';

        // é¡µé¢åŠ è½½æ—¶ï¼Œè‡ªåŠ¨ä» config.js è¯»å–æ•°æ®
        window.onload = function() {
            try {
                // è¯»å– config.js é‡Œçš„å˜é‡
                if (typeof STUDENTS_CONFIG !== 'undefined') {
                    students = JSON.parse(JSON.stringify(STUDENTS_CONFIG)); // æ·±æ‹·è´é˜²æ­¢å¼•ç”¨
                    renderTable();
                }
                if (typeof YUANQI_CONFIG !== 'undefined') {
                    currentToken = YUANQI_CONFIG.token;
                    currentApiUrl = YUANQI_CONFIG.apiUrl;
                    document.getElementById('currentTokenDisplay').innerText = currentToken.substring(0, 10) + '...';
                }
                
                // è‡ªåŠ¨å¡«å……æœ€åä¸€ä¸ªå­¦å‘˜çš„ AgentID æ–¹ä¾¿æ·»åŠ 
                if(students.length > 0) {
                    document.getElementById('agentId').value = students[students.length-1].agentId;
                }
            } catch (e) {
                alert('è¯»å– config.js å¤±è´¥ï¼Œè¯·ç¡®ä¿æ–‡ä»¶åœ¨åŒä¸€ç›®å½•ä¸‹');
                console.error(e);
            }
        };
        
        // æ·»åŠ å­¦å‘˜
        function addStudent() {
            const phone = document.getElementById('phone').value.trim();
            const pwd = document.getElementById('password').value.trim();
            const nm = document.getElementById('studentName').value.trim();
            const tnm = document.getElementById('teacherName').value.trim();
            const aid = document.getElementById('agentId').value.trim();
            
            if (!phone || !nm || !aid) { alert('æ‰‹æœºå·ã€å§“åã€AgentID å¿…å¡«'); return; }
            
            // æŸ¥é‡
            if (students.find(s => s.phone === phone)) { alert('è¯¥æ‰‹æœºå·å·²å­˜åœ¨ï¼'); return; }
            
            students.push({ phone, password: pwd, name: nm, teacherName: tnm, agentId: aid });
            
            // æ¸…ç©ºè¾“å…¥
            document.getElementById('phone').value = '';
            document.getElementById('studentName').value = '';
            
            renderTable();
            // è‡ªåŠ¨æ»šåŠ¨åˆ°åº•éƒ¨
            generateConfig(); // è‡ªåŠ¨ç”Ÿæˆé¢„è§ˆ
        }
        
        // åˆ é™¤å­¦å‘˜
        function deleteStudent(phone) {
            if(confirm('ç¡®è®¤åˆ é™¤ï¼Ÿ')) {
                students = students.filter(s => s.phone !== phone);
                renderTable();
                generateConfig();
            }
        }
        
        // æ¸²æŸ“åˆ—è¡¨
        function renderTable() {
            const tbody = document.getElementById('studentTableBody');
            document.getElementById('count').innerText = students.length;
            
            tbody.innerHTML = students.map(s => `
                <tr>
                    <td>${s.phone}</td>
                    <td>${s.name}</td>
                    <td>${s.password}</td>
                    <td><span class="badge">${s.teacherName}</span></td>
                    <td><button class="btn btn-danger" onclick="deleteStudent('${s.phone}')">åˆ é™¤</button></td>
                </tr>
            `).join('');
        }
        
        // ç”Ÿæˆä»£ç 
        function generateConfig() {
            const code = `// ===================================
// è…¾è®¯å…ƒå™¨ (Yuanqi) é…ç½®
// ===================================
const YUANQI_CONFIG = {
    token: '${currentToken}',
    apiUrl: '${currentApiUrl}'
};

// ===================================
// å­¦å‘˜ä¸è€å¸ˆé…ç½® (æ‰‹æœºå·ç‰ˆ)
// ===================================
const STUDENTS_CONFIG = [
${students.map(s => `    {
        phone: '${s.phone}',
        password: '${s.password}',
        name: '${s.name}',
        teacherName: '${s.teacherName}',
        agentId: '${s.agentId}'
    }`).join(',\n')}
];`;
            document.getElementById('configOutput').value = code;
        }

        function copyConfig() {
            const output = document.getElementById('configOutput');
            if(!output.value) generateConfig();
            output.select();
            document.execCommand('copy');
            alert('âœ… ä»£ç å·²å¤åˆ¶ï¼\n\nè¯·å» GitHub:\n1. æ‰“å¼€ config.js\n2. ç‚¹å‡»ç¼–è¾‘æŒ‰é’® (âœï¸)\n3. å…¨é€‰å¹¶ç²˜è´´è¦†ç›–\n4. æäº¤ä¿å­˜ (Commit)');
        }
    </script>
</body>
</html>
